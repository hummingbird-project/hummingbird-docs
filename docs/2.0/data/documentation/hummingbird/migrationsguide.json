{"identifier":{"url":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/MigrationsGuide","interfaceLanguage":"swift"},"sections":[],"hierarchy":{"paths":[["doc:\/\/com.opticalaberration.hummingbird\/documentation\/index"],["doc:\/\/com.opticalaberration.hummingbird\/documentation\/index","doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations"]]},"metadata":{"title":"Postgres Migrations","modules":[{"name":"PostgresMigrations"}],"roleHeading":"Article","role":"article","images":[{"identifier":"logo.png","type":"icon"}]},"schemaVersion":{"minor":3,"patch":0,"major":0},"primaryContentSections":[{"kind":"content","content":[{"text":"Overview","anchor":"Overview","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Database migrations are a controlled set of incremental changes applied to a database. You can use a migration list to transition a database from one state to a new desired state. A migration can involve creating\/deleting tables, adding\/removing columns, changing types and constraints. The "},{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations","isActive":true},{"text":" library provides support for setting up your own database migrations.","type":"text"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If you are using Fluent then you should use the migration support that comes with Fluent."}]}],"name":"Note","type":"aside","style":"note"},{"type":"paragraph","inlineContent":[{"text":"Each migration includs an ","type":"text"},{"code":"apply","type":"codeVoice"},{"text":" method that applies the change and a ","type":"text"},{"code":"revert","type":"codeVoice"},{"text":" method that reverts the change.","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["struct CreateMyTableMigration: DatabaseMigration {","    func apply(connection: PostgresConnection, logger: Logger) async throws {","        try await connection.query(","            \"\"\"","            CREATE TABLE my_table (","                \"id\" text PRIMARY KEY,","                \"name\" text NOT NULL","            )","            \"\"\",","            logger: logger","        )","    }","","    func revert(connection: PostgresConnection, logger: Logger) async throws {","        try await connection.query(","            \"DROP TABLE my_table\",","            logger: logger","        )","    }","}"]},{"type":"paragraph","inlineContent":[{"text":"As an individual migration can be dependent on the results of a previous migration the order they are applied has to be the same everytime. Migrations allow for database changes to be repeatable, shared and testable without loss of data.","type":"text"}]},{"text":"Adding migrations","anchor":"Adding-migrations","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"text":"You need to create a ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations","isActive":true,"type":"reference"},{"text":" object to store your migrations in. Only create one of these, otherwise you could confuse your database about what migrations need applied. Adding a migration is as simple as calling ","type":"text"},{"type":"codeVoice","code":"add"},{"text":".","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["import HummingbirdPostgres","","let migrations = DatabaseMigrations()","await migrations.add(CreateMyTableMigration())"]},{"text":"Applying migrations","anchor":"Applying-migrations","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"As you need an active "},{"code":"PostgresClient","type":"codeVoice"},{"type":"text","text":" to apply migrations you need to run the migrate once you have called "},{"code":"PostgresClient.run","type":"codeVoice"},{"type":"text","text":". It is also preferable to have run your migrations before your server is active and accepting connections. If you are using this package alongside Hummingbird the best way to do this is use "},{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/Application\/beforeServerStarts(perform:)","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"code":["var app = Application(router: router)","\/\/ add postgres client as a service to ensure it is active","app.addServices(postgresClient)","app.beforeServerStarts {","    try await migrations.apply(client: postgresClient, logger: logger, dryRun: true)","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"You will notice in the code above the parameter "},{"type":"codeVoice","code":"dryRun"},{"type":"text","text":" is set to true. This is because applying migrations can be a destructive process and should be a supervised. If there is a change in the migration list, with "},{"type":"codeVoice","code":"dryRun"},{"type":"text","text":" set to true, the "},{"type":"codeVoice","code":"apply"},{"type":"text","text":" function will throw an error and list the migrations it would apply. At that point you can make a call on whether you want to apply those changes and run the same process again except with "},{"type":"codeVoice","code":"dryRun"},{"type":"text","text":" set to false."}],"type":"paragraph"},{"text":"Reverting migrations","anchor":"Reverting-migrations","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"text":"You can use ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/revert(client:groups:options:logger:dryRun:)","type":"reference","isActive":true},{"text":" to revert all the migrations and will reset your database back to its starting point. If it comes across a migration name in the database it doesn’t recognise, it will throw the error ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationError\/cannotRevertMigration","type":"reference","isActive":true},{"text":". In this situation you have two options.","type":"text"}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Register the missing migration using "},{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/register(_:)","isActive":true},{"type":"text","text":". The system will now know about this migration but it will not apply it."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Run the ","type":"text"},{"type":"codeVoice","code":"revert"},{"text":" function again but including either option ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertOptions\/ignoreUnknownMigrations","type":"reference","isActive":true},{"text":" or ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertOptions\/removeUnknownMigrations","type":"reference","isActive":true},{"text":". This will either ignore the migration, or remove the database entry associated with that migration. The remove option will not revert the associated change though as it doesn’t know how to.","type":"text"}],"type":"paragraph"}]}]},{"type":"codeListing","code":["await migrations.revert(","    client: postgresClient, ","    options: .ignoreUnknownMigrations, ","    logger: logger, ","    dryRun: false",")"],"syntax":"swift"},{"type":"heading","level":3,"text":"Inconsistencies between expected and applied migrations","anchor":"Inconsistencies-between-expected-and-applied-migrations"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the order your application expects migrations to be applied and the order they have actually been applied is different then when you call "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/apply(client:groups:options:logger:dryRun:)"},{"type":"text","text":" it will throw a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationError\/appliedMigrationsInconsistent"},{"type":"text","text":" error. This can occur in a number of situations"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"A new migration has been inserted in the middle of the migration list","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A migration was removed from the middle of the migration list","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A migration was renamed","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A migration has been moved from one group to another (See the section on ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/MigrationsGuide#Migration-groups","isActive":true,"type":"reference"},{"text":" below)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The order of applying migrations has changed."}]}]}]},{"type":"paragraph","inlineContent":[{"text":"The best way to fix this is to ensure the order of migrations you would like to apply is consistent with the list of already applied migrations in your database. If this is not possible though you can use the function ","type":"text"},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/revertInconsistent(client:groups:options:logger:dryRun:)","type":"reference","isActive":true},{"text":" to revert applied migrations until the applied migration list is consistent with the list the application expects. This is a destructive function. Always run it with ","type":"text"},{"type":"codeVoice","code":"dryRun"},{"text":" set to ","type":"text"},{"type":"codeVoice","code":"true"},{"text":" first. With this set, it will output to the log the list of operations it will perform but not actually perform them.","type":"text"}]},{"type":"codeListing","code":["await migrations.revertInconsistent(","    client: postgresClient, ","    logger: logger, ","    dryRun: true",")"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"The default operation is to find the first inconsistency in the lists and then revert every migration after that as it cannot be certain they will have been applied correctly. This is obviously very destructive. You have a number of options that affect this operation.","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertInconsistentOptions\/ignoreUnknownMigrations","type":"reference"},{"type":"text","text":" will ignore any applied migrations the system doesn’t know about."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertInconsistentOptions\/removeUnknownMigrations","isActive":true},{"type":"text","text":" will remove any applied migrations the system doesn’t know about. This will also revert any migrations that follow the unknown migration."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertInconsistentOptions\/disableRevertsFollowingRevert","isActive":true},{"type":"text","text":" disables reverting any migrations that follow a migration that has been reverted. You should use this with care as subsequent migrations may depend on the reverted migration. With this option set if it finds a migration that has not been applied in the middle of the applied migrations it will ignore that migration and not revert any subsequent migrations."}]}]}]},{"type":"paragraph","inlineContent":[{"text":"This function is provided as a way to fixup inconsistencies but it should not be relied upon. Ensuring the order your migrations are applied is consistent is the best way to proceed.","type":"text"}]},{"type":"heading","level":3,"text":"Migration groups","anchor":"Migration-groups"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A migration group is a group of migrations that can be applied to a database independent of all other migrations outside that group. By default all migrations are added to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationGroup\/default"},{"type":"text","text":" migration group. Each group is applied independently to your database. A group allows for a modular piece of code to add additional migrations without affecting the ordering of other migrations and causing deletion of data."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To create a group you need to extend "},{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationGroup","isActive":true},{"type":"text","text":" and add a new static variable for the migration group id."}]},{"type":"codeListing","code":["extension DatabaseMigrationGroup {","    public static var myGroup: Self { .init(\"my_group\") }","}"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Then every migration that belongs to that group must set its group member variable"}]},{"type":"codeListing","code":["extension CreateMyTableMigration {","    var group: DatabaseMigrationGroup { .myGroup }","}"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"You should only use groups if you can guarantee the migrations inside it will always be independent of migrations outside the group.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The persist driver that come with "},{"isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdPostgres","type":"reference"},{"type":"text","text":" and the job queue driver from "},{"isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/JobsPostgres","type":"reference"},{"type":"text","text":" both use groups to separate their migrations from any the user might add."}]}]}],"seeAlsoSections":[{"anchor":"Related-Documentation","identifiers":["doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigration","doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations"],"title":"Related Documentation"},{"anchor":"Database-Integration","identifiers":["doc:\/\/com.opticalaberration.hummingbird\/tutorials\/Fluent","doc:\/\/com.opticalaberration.hummingbird\/tutorials\/MongoKitten"],"generated":true,"title":"Database Integration"}],"abstract":[{"text":"Managing database structure changes.","type":"text"}],"kind":"article","references":{"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrationGroup":{"title":"DatabaseMigrationGroup","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationGroup","type":"topic","role":"symbol","navigatorTitle":[{"text":"DatabaseMigrationGroup","kind":"identifier"}],"kind":"symbol","abstract":[{"text":"Group identifier for a group of migrations.","type":"text"}],"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"DatabaseMigrationGroup","kind":"identifier"}],"url":"\/documentation\/postgresmigrations\/databasemigrationgroup"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/RevertInconsistentOptions/disableRevertsFollowingRevert":{"kind":"symbol","title":"disableRevertsFollowingRevert","role":"symbol","fragments":[{"text":"static","kind":"keyword"},{"text":" ","kind":"text"},{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"disableRevertsFollowingRevert","kind":"identifier"},{"text":": `Self`","kind":"text"}],"type":"topic","abstract":[{"type":"text","text":"Disable the reverting of migrations that follow an applied migration that is inconsistent"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertInconsistentOptions\/disableRevertsFollowingRevert","url":"\/documentation\/postgresmigrations\/databasemigrations\/revertinconsistentoptions\/disablerevertsfollowingrevert"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations":{"abstract":[{"type":"text","text":"Database migration support"}],"navigatorTitle":[{"kind":"identifier","text":"DatabaseMigrations"}],"type":"topic","fragments":[{"kind":"keyword","text":"actor"},{"kind":"text","text":" "},{"kind":"identifier","text":"DatabaseMigrations"}],"kind":"symbol","role":"symbol","url":"\/documentation\/postgresmigrations\/databasemigrations","title":"DatabaseMigrations","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations"},"doc://com.opticalaberration.hummingbird/documentation/JobsPostgres":{"type":"topic","abstract":[{"type":"text","text":"Postgres implementation for Hummingbird jobs framework"}],"images":[{"identifier":"logo.png","type":"icon"}],"url":"\/documentation\/jobspostgres","kind":"symbol","title":"JobsPostgres","role":"collection","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/JobsPostgres"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/RevertOptions/ignoreUnknownMigrations":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertOptions\/ignoreUnknownMigrations","fragments":[{"text":"static","kind":"keyword"},{"text":" ","kind":"text"},{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ignoreUnknownMigrations","kind":"identifier"},{"text":": `Self`","kind":"text"}],"type":"topic","abstract":[{"type":"text","text":"Ignore migrations we don’t know about"}],"title":"ignoreUnknownMigrations","kind":"symbol","url":"\/documentation\/postgresmigrations\/databasemigrations\/revertoptions\/ignoreunknownmigrations","role":"symbol"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/RevertInconsistentOptions/removeUnknownMigrations":{"title":"removeUnknownMigrations","kind":"symbol","role":"symbol","fragments":[{"text":"static","kind":"keyword"},{"text":" ","kind":"text"},{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"removeUnknownMigrations","kind":"identifier"},{"text":": `Self`","kind":"text"}],"type":"topic","abstract":[{"type":"text","text":"Remove database entry for migrations we don’t know about"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertInconsistentOptions\/removeUnknownMigrations","url":"\/documentation\/postgresmigrations\/databasemigrations\/revertinconsistentoptions\/removeunknownmigrations"},"doc://com.opticalaberration.hummingbird/documentation/Hummingbird/Application/beforeServerStarts(perform:)":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/Application\/beforeServerStarts(perform:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"beforeServerStarts","kind":"identifier"},{"text":"(","kind":"text"},{"text":"perform","kind":"externalParam"},{"text":": () ","kind":"text"},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Void","preciseIdentifier":"s:s4Voida"},{"kind":"text","text":")"}],"type":"topic","abstract":[{"type":"text","text":"Add a process to run before we kick off the server service"}],"kind":"symbol","url":"\/documentation\/hummingbird\/application\/beforeserverstarts(perform:)","title":"beforeServerStarts(perform:)","role":"symbol"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/register(_:)":{"title":"register(_:)","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/register(_:)","type":"topic","role":"symbol","kind":"symbol","abstract":[{"text":"Register migration without it being applied","type":"text"}],"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"register"},{"kind":"text","text":"("},{"kind":"keyword","text":"any"},{"kind":"text","text":" "},{"preciseIdentifier":"s:18PostgresMigrations17DatabaseMigrationP","kind":"typeIdentifier","text":"DatabaseMigration"},{"kind":"text","text":")"}],"url":"\/documentation\/postgresmigrations\/databasemigrations\/register(_:)"},"logo.png":{"alt":null,"type":"image","identifier":"logo.png","variants":[{"url":"\/images\/com.opticalaberration.hummingbird\/logo.png","traits":["1x","light"]}]},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrationError/cannotRevertMigration":{"type":"topic","abstract":[{"text":"Cannot revert a migration as we do not have its details. Add it to the revert list using","type":"text"},{"text":" ","type":"text"},{"text":"PostgresMigrations.register()","type":"text"}],"url":"\/documentation\/postgresmigrations\/databasemigrationerror\/cannotrevertmigration","kind":"symbol","title":"cannotRevertMigration","role":"symbol","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"cannotRevertMigration"},{"kind":"text","text":": `Self`"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationError\/cannotRevertMigration"},"doc://com.opticalaberration.hummingbird/documentation/index":{"type":"topic","abstract":[{"type":"text","text":"Documentation for Hummingbird the lightweight, flexible, modern server framework."}],"images":[{"identifier":"logo.png","type":"icon"}],"url":"\/documentation\/index","kind":"article","title":"Hummingbird Documentation","role":"collection","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/index"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations","url":"\/documentation\/postgresmigrations","type":"topic","role":"collection","abstract":[{"type":"text","text":"Postgres database migration service"}],"kind":"symbol","images":[{"type":"icon","identifier":"logo.png"}],"title":"PostgresMigrations"},"doc://com.opticalaberration.hummingbird/documentation/Hummingbird/MigrationsGuide#Migration-groups":{"type":"topic","title":"Migration groups","url":"\/documentation\/hummingbird\/migrationsguide#Migration-groups","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/MigrationsGuide#Migration-groups","abstract":[],"kind":"section"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/revert(client:groups:options:logger:dryRun:)":{"abstract":[{"type":"text","text":"Revert database migrations"}],"type":"topic","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"revert"},{"kind":"text","text":"("},{"kind":"externalParam","text":"client"},{"kind":"text","text":": "},{"preciseIdentifier":"s:11PostgresNIO0A6ClientC","text":"PostgresClient","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"groups","kind":"externalParam"},{"text":": [","kind":"text"},{"preciseIdentifier":"s:18PostgresMigrations22DatabaseMigrationGroupV","text":"DatabaseMigrationGroup","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"text":"options","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"RevertOptions","preciseIdentifier":"s:18PostgresMigrations08DatabaseB0C13RevertOptionsV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"logger"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Logger","preciseIdentifier":"s:7Logging6LoggerV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"dryRun"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"}],"kind":"symbol","role":"symbol","url":"\/documentation\/postgresmigrations\/databasemigrations\/revert(client:groups:options:logger:dryrun:)","title":"revert(client:groups:options:logger:dryRun:)","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/revert(client:groups:options:logger:dryRun:)"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrationError/appliedMigrationsInconsistent":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationError\/appliedMigrationsInconsistent","url":"\/documentation\/postgresmigrations\/databasemigrationerror\/appliedmigrationsinconsistent","fragments":[{"text":"static","kind":"keyword"},{"text":" ","kind":"text"},{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"appliedMigrationsInconsistent","kind":"identifier"},{"kind":"text","text":": `Self`"}],"type":"topic","role":"symbol","abstract":[{"type":"text","text":"Applied migrations are inconsistent with expected list"}],"kind":"symbol","title":"appliedMigrationsInconsistent"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/apply(client:groups:options:logger:dryRun:)":{"url":"\/documentation\/postgresmigrations\/databasemigrations\/apply(client:groups:options:logger:dryrun:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"apply","kind":"identifier"},{"text":"(","kind":"text"},{"text":"client","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:11PostgresNIO0A6ClientC","text":"PostgresClient","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"groups","kind":"externalParam"},{"text":": [","kind":"text"},{"preciseIdentifier":"s:18PostgresMigrations22DatabaseMigrationGroupV","text":"DatabaseMigrationGroup","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"text":"options","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:18PostgresMigrations08DatabaseB0C12ApplyOptionsV","text":"ApplyOptions","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"logger","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:7Logging6LoggerV","text":"Logger","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"kind":"externalParam","text":"dryRun"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:Sb","text":"Bool"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/apply(client:groups:options:logger:dryRun:)","kind":"symbol","abstract":[{"type":"text","text":"Apply database migrations"}],"type":"topic","role":"symbol","title":"apply(client:groups:options:logger:dryRun:)"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/RevertInconsistentOptions/ignoreUnknownMigrations":{"title":"ignoreUnknownMigrations","kind":"symbol","role":"symbol","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"ignoreUnknownMigrations"},{"kind":"text","text":": `Self`"}],"type":"topic","abstract":[{"text":"Ignore migrations we don’t know about","type":"text"}],"url":"\/documentation\/postgresmigrations\/databasemigrations\/revertinconsistentoptions\/ignoreunknownmigrations","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertInconsistentOptions\/ignoreUnknownMigrations"},"doc://com.opticalaberration.hummingbird/tutorials/Fluent":{"url":"\/tutorials\/fluent","type":"topic","title":"Store Data with Fluent","identifier":"doc:\/\/com.opticalaberration.hummingbird\/tutorials\/Fluent","role":"overview","kind":"overview","abstract":[{"text":"A tutorial that shows you how to set up Hummingbird 2 with Fluent to create and access your Galaxies.","type":"text"}]},"doc://com.opticalaberration.hummingbird/documentation/HummingbirdPostgres":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdPostgres","url":"\/documentation\/hummingbirdpostgres","type":"topic","role":"collection","abstract":[{"type":"text","text":"Working with Postgres databases."}],"kind":"symbol","images":[{"identifier":"logo.png","type":"icon"}],"title":"HummingbirdPostgres"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrationGroup/default":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrationGroup\/default","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"`default`"},{"kind":"text","text":": `Self`"}],"url":"\/documentation\/postgresmigrations\/databasemigrationgroup\/default","abstract":[],"kind":"symbol","title":"default","type":"topic","role":"symbol"},"doc://com.opticalaberration.hummingbird/tutorials/MongoKitten":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/tutorials\/MongoKitten","role":"overview","kind":"overview","url":"\/tutorials\/mongokitten","title":"Store Data with MongoKitten","abstract":[{"type":"text","text":"A tutorial that shows you how to set up Hummingbird 2 with MongoKitten to create and share your kittens."}],"type":"topic"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigration":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigration","title":"DatabaseMigration","type":"topic","role":"symbol","navigatorTitle":[{"text":"DatabaseMigration","kind":"identifier"}],"kind":"symbol","abstract":[{"type":"text","text":"Protocol for a database migration"}],"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"DatabaseMigration","kind":"identifier"}],"url":"\/documentation\/postgresmigrations\/databasemigration"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/revertInconsistent(client:groups:options:logger:dryRun:)":{"type":"topic","abstract":[{"text":"Revert database migrations that are inconsistent with the migration list","type":"text"}],"url":"\/documentation\/postgresmigrations\/databasemigrations\/revertinconsistent(client:groups:options:logger:dryrun:)","kind":"symbol","title":"revertInconsistent(client:groups:options:logger:dryRun:)","role":"symbol","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"revertInconsistent"},{"kind":"text","text":"("},{"kind":"externalParam","text":"client"},{"kind":"text","text":": "},{"preciseIdentifier":"s:11PostgresNIO0A6ClientC","text":"PostgresClient","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"groups","kind":"externalParam"},{"text":": [","kind":"text"},{"preciseIdentifier":"s:18PostgresMigrations22DatabaseMigrationGroupV","text":"DatabaseMigrationGroup","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"text":"options","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"RevertInconsistentOptions","kind":"typeIdentifier","preciseIdentifier":"s:18PostgresMigrations08DatabaseB0C25RevertInconsistentOptionsV"},{"text":", ","kind":"text"},{"text":"logger","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Logger","kind":"typeIdentifier","preciseIdentifier":"s:7Logging6LoggerV"},{"text":", ","kind":"text"},{"kind":"externalParam","text":"dryRun"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:Sb","text":"Bool"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/revertInconsistent(client:groups:options:logger:dryRun:)"},"doc://com.opticalaberration.hummingbird/documentation/PostgresMigrations/DatabaseMigrations/RevertOptions/removeUnknownMigrations":{"kind":"symbol","title":"removeUnknownMigrations","role":"symbol","fragments":[{"text":"static","kind":"keyword"},{"text":" ","kind":"text"},{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"removeUnknownMigrations","kind":"identifier"},{"text":": `Self`","kind":"text"}],"type":"topic","abstract":[{"type":"text","text":"Remove database entry for migrations we don’t know about"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/PostgresMigrations\/DatabaseMigrations\/RevertOptions\/removeUnknownMigrations","url":"\/documentation\/postgresmigrations\/databasemigrations\/revertoptions\/removeunknownmigrations"}}}